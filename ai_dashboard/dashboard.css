/* ─────────────────────────────────────────────────────────
   Google Fonts (must be first for PostCSS @import ordering)
   ───────────────────────────────────────────────────────── */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&family=Space+Grotesk:wght@400;500;600;700;800&display=swap');

/* ─────────────────────────────────────────────────────────
   Tailwind CSS — processed by PostCSS via Vite
   ───────────────────────────────────────────────────────── */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* ─────────────────────────────────────────────────────────
   Base resets on top of Tailwind
   ───────────────────────────────────────────────────────── */
@layer base {

  html,
  body {
    @apply h-full;
  }

  body {
    @apply bg-[#060610] text-slate-100 font-sans antialiased overflow-x-hidden;
  }

  ::-webkit-scrollbar {
    @apply w-1 h-1;
  }

  ::-webkit-scrollbar-track {
    background: transparent;
  }

  ::-webkit-scrollbar-thumb {
    @apply bg-white/10 rounded-full;
  }

  ::-webkit-scrollbar-thumb:hover {
    @apply bg-white/20;
  }

  * {
    box-sizing: border-box;
  }
}

/* ─────────────────────────────────────────────────────────
   Component layer — reusable patterns
   ───────────────────────────────────────────────────────── */
@layer components {

  /* Panel glass card */
  .panel-card {
    @apply relative overflow-hidden rounded-2xl bg-white/[0.025] border border-white/[0.06] p-5 transition-[border-color] duration-300;
  }

  .panel-card::before {
    content: '';
    @apply absolute inset-0 pointer-events-none rounded-2xl;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.035) 0%, transparent 60%);
  }

  /* Vital card */
  .vital-card {
    @apply relative overflow-hidden flex items-center gap-3 px-4 py-3.5 rounded-2xl bg-white/[0.025] border border-white/[0.06] cursor-default;
  }

  .vital-card::before {
    content: '';
    @apply absolute inset-0 pointer-events-none rounded-2xl;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.02) 0%, transparent 60%);
  }

  /* Sidebar control buttons */
  .ctrl-btn {
    @apply flex items-center gap-2 w-full px-4 py-2.5 rounded-xl text-[12.5px] font-semibold border border-transparent transition-all duration-200 disabled:opacity-30 disabled:cursor-not-allowed;
  }

  .start-btn {
    @apply bg-emerald-500/10 border-emerald-400/25 text-emerald-300;
  }

  .start-btn:not(:disabled):hover {
    @apply bg-emerald-500/20 shadow-green -translate-y-px;
  }

  .stop-btn {
    @apply bg-rose-500/10 border-rose-400/25 text-rose-300;
  }

  .stop-btn:not(:disabled):hover {
    @apply bg-rose-500/20 shadow-rose -translate-y-px;
  }

  .ai-btn {
    @apply bg-violet-500/15 border-violet-400/30 text-violet-300 shadow-violet/10;
  }

  .ai-btn:not(:disabled):hover {
    @apply bg-violet-500/25 shadow-violet -translate-y-px;
  }

  /* Status chip */
  .status-chip {
    @apply flex items-center gap-1.5 self-start px-3 py-1 rounded-full text-[11px] font-semibold border;
  }

  .status-chip.disconnected {
    @apply bg-rose-400/10 text-rose-400 border-rose-400/20;
  }

  .status-chip.connected {
    @apply bg-emerald-400/10 text-emerald-400 border-emerald-400/20;
  }

  .status-chip.recording {
    @apply bg-amber-400/10 text-amber-400 border-amber-400/20;
  }

  /* Status dot inside chip */
  .status-dot {
    @apply w-1.5 h-1.5 rounded-full;
  }

  .status-chip.disconnected .status-dot {
    @apply bg-rose-400;
  }

  .status-chip.connected .status-dot {
    @apply bg-emerald-400 animate-pulse;
  }

  .status-chip.recording .status-dot {
    @apply bg-amber-400;
    animation: blink 0.8s infinite;
  }

  /* Accent icon wrap */
  .icon-wrap {
    @apply w-9 h-9 rounded-xl flex items-center justify-center flex-shrink-0 border;
  }

  .icon-wrap.teal {
    @apply bg-teal-400/10 border-teal-400/20 text-teal-400;
  }

  .icon-wrap.emerald {
    @apply bg-emerald-400/10 border-emerald-400/20 text-emerald-400;
  }

  .icon-wrap.rose {
    @apply bg-rose-400/10 border-rose-400/20 text-rose-400;
  }

  .icon-wrap.violet {
    @apply bg-violet-400/10 border-violet-400/20 text-violet-400;
  }

  .icon-wrap.amber {
    @apply bg-amber-400/10 border-amber-400/20 text-amber-400;
  }

  .icon-wrap.muted {
    @apply bg-white/[0.04] border-white/[0.06] text-slate-500;
  }

  /* Panel label icon (smaller) */
  .panel-icon {
    @apply w-7 h-7 rounded-lg flex items-center justify-center border;
  }

  /* Section header row */
  .panel-header {
    @apply flex items-center justify-between mb-4;
  }

  /* Panel section label */
  .panel-label {
    @apply flex items-center gap-2.5;
  }

  .panel-label-text {
    @apply text-[11px] font-bold uppercase tracking-widest text-slate-400;
  }

  /* AI confidence chips */
  .ai-chip {
    @apply inline-flex items-center gap-1.5 px-3 py-1 rounded-lg text-[11px] font-bold border;
  }

  .ai-chip.high {
    @apply bg-emerald-400/10 text-emerald-400 border-emerald-400/20;
  }

  .ai-chip.moderate {
    @apply bg-amber-400/10 text-amber-400 border-amber-400/20;
  }

  .ai-chip.low {
    @apply bg-rose-400/10 text-rose-400 border-rose-400/20;
  }

  /* AI spinner */
  .ai-spinner {
    @apply inline-block w-3.5 h-3.5 rounded-full border-2 border-violet-400/20 border-t-violet-400;
    animation: spin 0.7s linear infinite;
  }

  /* Event log */
  .event-log {
    @apply font-mono text-[11px] text-slate-500 bg-black/30 border border-white/[0.05] rounded-xl p-3 max-h-44 overflow-y-auto leading-[1.8] whitespace-pre-wrap;
  }

  /* AI content typography */
  .ai-content h3 {
    @apply text-violet-400 text-[11px] font-bold uppercase tracking-widest mt-3.5 mb-1.5;
  }

  .ai-content h3:first-child {
    @apply mt-0;
  }

  .ai-content strong {
    @apply text-slate-200;
  }
}

/* ─────────────────────────────────────────────────────────
   Keyframe animations (can't be expressed in Tailwind alone)
   ───────────────────────────────────────────────────────── */
@keyframes blink {

  0%,
  100% {
    opacity: 1
  }

  50% {
    opacity: .2
  }
}

@keyframes spin {
  to {
    transform: rotate(360deg)
  }
}

@keyframes scanline {
  0% {
    transform: translateY(-100%)
  }

  100% {
    transform: translateY(100%)
  }
}

@keyframes orb-drift {
  0% {
    transform: translate(0, 0)
  }

  100% {
    transform: translate(40px, 25px)
  }
}

@keyframes ai-pulse {
  0% {
    box-shadow: 0 0 0 0 rgba(251, 191, 36, 0.6);
  }

  70% {
    box-shadow: 0 0 0 10px rgba(251, 191, 36, 0);
  }

  100% {
    box-shadow: 0 0 0 0 rgba(251, 191, 36, 0);
  }
}

/* ─────────────────────────────────────────────────────────
   Utility layer — one-off helpers
   ───────────────────────────────────────────────────────── */
@layer utilities {

  /* Canvas Chart.js sizing fix */
  .chart-canvas {
    @apply absolute inset-0;
    width: 100% !important;
    height: 100% !important;
  }

  /* Scanline sweep on ECG */
  .scanline {
    @apply absolute inset-0 pointer-events-none;
    background: linear-gradient(to bottom, transparent 0%, rgba(45, 212, 191, 0.025) 50%, transparent 100%);
    animation: scanline 3.5s linear infinite;
  }

  /* Ambient glow orb drift */
  .glow-orb {
    animation: orb-drift 14s ease-in-out infinite alternate;
  }

  .glow-orb:nth-child(2) {
    animation-delay: -5s;
  }

  .glow-orb:nth-child(3) {
    animation-delay: -10s;
  }

  /* GSAP fade-in targets */
  .fade-item {
    opacity: 0;
    transform: translateY(18px);
  }

  /* Recording state — AI pulse ring */
  body.recording #aiPulse {
    background: #fbbf24;
    animation: ai-pulse 1.5s infinite;
  }

  /* Dot-grid background overlay */
  .dot-grid {
    background-image: radial-gradient(rgba(255, 255, 255, 0.07) 1px, transparent 1px);
    background-size: 32px 32px;
  }
}

/* ─────────────────────────────────────────────────────────
   STANDARDIZED TESTS — Modal & UI styles
   ───────────────────────────────────────────────────────── */

/* Full-screen test overlay */
.test-modal {
  position: fixed;
  inset: 0;
  z-index: 60;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

.test-modal.hidden {
  display: none;
}

/* Phase badge pill in modal header */
.test-phase-badge {
  display: inline-flex;
  align-items: center;
  font-size: 10px;
  font-weight: 700;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  padding: 3px 10px;
  border-radius: 9999px;
  background: rgba(56, 189, 248, 0.12);
  border: 1px solid rgba(56, 189, 248, 0.28);
  color: #38bdf8;
}

/* SVG animation container */
.tm-anim-area {
  width: 240px;
  height: 220px;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
}

.phase-anim {
  width: 100%;
  height: 100%;
  filter: drop-shadow(0 0 18px rgba(45, 212, 191, 0.18));
  transition: opacity 0.3s ease;
}

/* Countdown ring transition handled via JS style.strokeDashoffset */
#cdRing {
  stroke-linecap: round;
}

/* Tests sidebar button */
.tests-btn {
  background: rgba(56, 189, 248, 0.08);
  border-color: rgba(56, 189, 248, 0.22);
  color: #7dd3fc;
}

.tests-btn:hover {
  background: rgba(56, 189, 248, 0.16);
  border-color: rgba(56, 189, 248, 0.38);
  transform: translateY(-1px);
  box-shadow: 0 0 18px rgba(56, 189, 248, 0.12);
}

/* Profiles sidebar link */
#btnProfiles:hover {
  background: linear-gradient(135deg, rgba(139, 92, 246, 0.18), rgba(45, 212, 191, 0.1)) !important;
  border-color: rgba(139, 92, 246, 0.4) !important;
  transform: translateY(-1px);
  box-shadow: 0 0 18px rgba(139, 92, 246, 0.12);
}

/* Test results card — phase tabs */
.test-result-tab {
  flex: 1;
  padding: 5px 8px;
  font-size: 11px;
  font-weight: 700;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  border-radius: 8px;
  border: 1px solid rgba(255, 255, 255, 0.06);
  background: rgba(255, 255, 255, 0.025);
  color: #475569;
  cursor: pointer;
  transition: all 0.18s ease;
}

.test-result-tab:hover {
  background: rgba(56, 189, 248, 0.08);
  border-color: rgba(56, 189, 248, 0.22);
  color: #7dd3fc;
}

.test-result-tab.active {
  background: rgba(56, 189, 248, 0.14);
  border-color: rgba(56, 189, 248, 0.35);
  color: #38bdf8;
  box-shadow: 0 0 12px rgba(56, 189, 248, 0.12);
}

/* AI confidence chip reused in test results */
.ai-confidence-chip {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 3px 10px;
  border-radius: 8px;
  font-size: 11px;
  font-weight: 700;
  border: 1px solid;
}

.ai-confidence-chip.high {
  background: rgba(52, 211, 153, 0.1);
  color: #34d399;
  border-color: rgba(52, 211, 153, 0.2);
}

.ai-confidence-chip.moderate {
  background: rgba(251, 191, 36, 0.1);
  color: #fbbf24;
  border-color: rgba(251, 191, 36, 0.2);
}

.ai-confidence-chip.low {
  background: rgba(251, 113, 133, 0.1);
  color: #fb7185;
  border-color: rgba(251, 113, 133, 0.2);
}

/* Custom scrollbar for test results content */
.custom-scroll::-webkit-scrollbar {
  width: 4px;
}

.custom-scroll::-webkit-scrollbar-track {
  background: transparent;
}

.custom-scroll::-webkit-scrollbar-thumb {
  background: rgba(56, 189, 248, 0.2);
  border-radius: 4px;
}

/* Postural & rest anim glow filters */
#anim-postural {
  filter: drop-shadow(0 0 18px rgba(139, 92, 246, 0.2));
}

#anim-movement {
  filter: drop-shadow(0 0 16px rgba(45, 212, 191, 0.2));
}

/* ─────────────────────────────────────────────────────────
   Responsive overrides
   ───────────────────────────────────────────────────────── */
@media (max-width: 1300px) {
  #dashGrid {
    grid-template-columns: 1fr 380px !important;
  }

  #dashGrid>.col-center {
    display: none;
  }
}

@media (max-width: 900px) {
  #sidebar {
    display: none !important;
  }

  main {
    margin-left: 0 !important;
  }

  #dashGrid {
    grid-template-columns: 1fr !important;
  }

  #dashGrid>.col-right {
    display: none;
  }

  #vitalsStrip {
    grid-template-columns: repeat(2, 1fr) !important;
  }
}